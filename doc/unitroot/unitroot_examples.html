
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Unit Root Testing &#8212; arch 0+untagged.89.g6a9b5a1 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0+untagged.89.g6a9b5a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Unit Root Tests" href="tests.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
  
   

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tests.html" title="The Unit Root Tests"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">arch 0+untagged.89.g6a9b5a1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="unitroot.html" accesskey="U">Unit Root Testing</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../index.html" class="text-logo">arch 0.+</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../univariate/univariate.html">Univariate Volatility Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bootstrap/bootstrap.html">Bootstrapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multiple-comparison/multiple-comparisons.html">Multiple Comparison Problems</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="unitroot.html">Unit Root Tests</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="tests.html">Unit Root Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Change Log</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="unitroot.html">Unit Root Testing</a></li>
              
              <li>Unit Root Testing</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="unit-root-testing">
<h1>Unit Root Testing<a class="headerlink" href="#unit-root-testing" title="Permalink to this headline">¶</a></h1>
<p><em>This setup code is required to run in an IPython notebook</em></p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
</pre></div>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Most examples will make use of the Default premium, which is the
difference between the yields of BAA and AAA rated corporate bonds. The
data is downloaded from FRED using pandas.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>
<span class="n">aaa</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="s2">&quot;fred&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1919</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">baa</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s2">&quot;BAA&quot;</span><span class="p">,</span> <span class="s2">&quot;fred&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1919</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">baa</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">aaa</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span>
<span class="n">default</span> <span class="o">=</span> <span class="n">baa</span> <span class="o">-</span> <span class="n">aaa</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/output_5_0.png" src="../_images/output_5_0.png" />
<p>The Default premium is clearly highly persistent. A simple check of the
autocorrelations confirms this.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">acf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">default</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ACF&#39;</span><span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">acf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Autocorrelations&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/output_7_0.png" src="../_images/output_7_0.png" />
</div>
<div class="section" id="agumented-dickey-fuller-testing">
<h2>Agumented Dickey-Fuller Testing<a class="headerlink" href="#agumented-dickey-fuller-testing" title="Permalink to this headline">¶</a></h2>
<p>The Augmented Dickey-Fuller test is the most common unit root test used.
It is a regression of the first difference of the variable on its lagged
level as well as additional lags of the first difference. The null is
that the series contains a unit root, and the (one-sided) alternative is
that the series is stationary.</p>
<p>By default, the number of lags is selected by minimizing the AIC across
a range of lag lengths (which can be set using <code class="docutils literal"><span class="pre">max_lag</span></code> when
initializing the model). Additionally, the basic test includes a
constant in the ADF regression.</p>
<p>These results indicate that the Default premium is stationary.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arch.unitroot</span> <span class="k">import</span> <span class="n">ADF</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">ADF</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adf</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">Augmented</span> <span class="n">Dickey</span><span class="o">-</span><span class="n">Fuller</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">3.241</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.018</span>
<span class="n">Lags</span>                               <span class="mi">21</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.44</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.86</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.57</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
<p>The number of lags can be directly set using <code class="docutils literal"><span class="pre">lags</span></code>. Changing the
number of lags makes no difference to the conclusion.</p>
<p><strong>Note</strong>: The ADF assumes residuals are white noise, and that the number
of lags is sufficient to pick up any dependence in the data.</p>
<div class="section" id="setting-the-number-of-lags">
<h3>Setting the number of lags<a class="headerlink" href="#setting-the-number-of-lags" title="Permalink to this headline">¶</a></h3>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">adf</span><span class="o">.</span><span class="n">lags</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adf</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">Augmented</span> <span class="n">Dickey</span><span class="o">-</span><span class="n">Fuller</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">3.427</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.010</span>
<span class="n">Lags</span>                                <span class="mi">5</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.44</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.86</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.57</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="deterministic-terms">
<h3>Deterministic terms<a class="headerlink" href="#deterministic-terms" title="Permalink to this headline">¶</a></h3>
<p>The deterministic terms can be altered using <code class="docutils literal"><span class="pre">trend</span></code>. The options are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">'nc'</span></code> : No deterministi terms</li>
<li><code class="docutils literal"><span class="pre">'c'</span></code> : Constant only</li>
<li><code class="docutils literal"><span class="pre">'ct'</span></code> : Constant and time trend</li>
<li><code class="docutils literal"><span class="pre">'ctt'</span></code> : Constant, time trend and time-trend squared</li>
</ul>
<p>Changing the type of constant also makes no difference for this data.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">adf</span><span class="o">.</span><span class="n">trend</span> <span class="o">=</span> <span class="s1">&#39;ct&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adf</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">Augmented</span> <span class="n">Dickey</span><span class="o">-</span><span class="n">Fuller</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">3.661</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.025</span>
<span class="n">Lags</span>                                <span class="mi">5</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span> <span class="ow">and</span> <span class="n">Linear</span> <span class="n">Time</span> <span class="n">Trend</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.97</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">3.41</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">3.13</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="regression-output">
<h3>Regression output<a class="headerlink" href="#regression-output" title="Permalink to this headline">¶</a></h3>
<p>The ADF uses a standard regression when computing results. These can be
accesses using <code class="docutils literal"><span class="pre">regression</span></code>.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">reg_res</span> <span class="o">=</span> <span class="n">adf</span><span class="o">.</span><span class="n">regression</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>                            <span class="n">OLS</span> <span class="n">Regression</span> <span class="n">Results</span>
<span class="o">==============================================================================</span>
<span class="n">Dep</span><span class="o">.</span> <span class="n">Variable</span><span class="p">:</span>                      <span class="n">y</span>   <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>                       <span class="mf">0.095</span>
<span class="n">Model</span><span class="p">:</span>                            <span class="n">OLS</span>   <span class="n">Adj</span><span class="o">.</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>                  <span class="mf">0.090</span>
<span class="n">Method</span><span class="p">:</span>                 <span class="n">Least</span> <span class="n">Squares</span>   <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span>                     <span class="mf">17.00</span>
<span class="n">Date</span><span class="p">:</span>                <span class="n">Thu</span><span class="p">,</span> <span class="mi">04</span> <span class="n">Aug</span> <span class="mi">2016</span>   <span class="n">Prob</span> <span class="p">(</span><span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">):</span>           <span class="mf">1.84e-21</span>
<span class="n">Time</span><span class="p">:</span>                        <span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">18</span>   <span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="p">:</span>                 <span class="mf">575.20</span>
<span class="n">No</span><span class="o">.</span> <span class="n">Observations</span><span class="p">:</span>                <span class="mi">1135</span>   <span class="n">AIC</span><span class="p">:</span>                            <span class="o">-</span><span class="mf">1134.</span>
<span class="n">Df</span> <span class="n">Residuals</span><span class="p">:</span>                    <span class="mi">1127</span>   <span class="n">BIC</span><span class="p">:</span>                            <span class="o">-</span><span class="mf">1094.</span>
<span class="n">Df</span> <span class="n">Model</span><span class="p">:</span>                           <span class="mi">7</span>
<span class="n">Covariance</span> <span class="n">Type</span><span class="p">:</span>            <span class="n">nonrobust</span>
<span class="o">==============================================================================</span>
                 <span class="n">coef</span>    <span class="n">std</span> <span class="n">err</span>          <span class="n">t</span>      <span class="n">P</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span>      <span class="p">[</span><span class="mf">0.025</span>      <span class="mf">0.975</span><span class="p">]</span>
<span class="o">------------------------------------------------------------------------------</span>
<span class="n">x1</span>            <span class="o">-</span><span class="mf">0.0246</span>      <span class="mf">0.007</span>     <span class="o">-</span><span class="mf">3.661</span>      <span class="mf">0.000</span>      <span class="o">-</span><span class="mf">0.038</span>      <span class="o">-</span><span class="mf">0.011</span>
<span class="n">x2</span>             <span class="mf">0.2190</span>      <span class="mf">0.030</span>      <span class="mf">7.344</span>      <span class="mf">0.000</span>       <span class="mf">0.160</span>       <span class="mf">0.277</span>
<span class="n">x3</span>            <span class="o">-</span><span class="mf">0.0549</span>      <span class="mf">0.030</span>     <span class="o">-</span><span class="mf">1.802</span>      <span class="mf">0.072</span>      <span class="o">-</span><span class="mf">0.115</span>       <span class="mf">0.005</span>
<span class="n">x4</span>            <span class="o">-</span><span class="mf">0.1398</span>      <span class="mf">0.030</span>     <span class="o">-</span><span class="mf">4.649</span>      <span class="mf">0.000</span>      <span class="o">-</span><span class="mf">0.199</span>      <span class="o">-</span><span class="mf">0.081</span>
<span class="n">x5</span>            <span class="o">-</span><span class="mf">0.0519</span>      <span class="mf">0.030</span>     <span class="o">-</span><span class="mf">1.716</span>      <span class="mf">0.086</span>      <span class="o">-</span><span class="mf">0.111</span>       <span class="mf">0.007</span>
<span class="n">x6</span>             <span class="mf">0.0426</span>      <span class="mf">0.030</span>      <span class="mf">1.431</span>      <span class="mf">0.153</span>      <span class="o">-</span><span class="mf">0.016</span>       <span class="mf">0.101</span>
<span class="n">const</span>          <span class="mf">0.0389</span>      <span class="mf">0.014</span>      <span class="mf">2.796</span>      <span class="mf">0.005</span>       <span class="mf">0.012</span>       <span class="mf">0.066</span>
<span class="n">x7</span>         <span class="o">-</span><span class="mf">1.817e-05</span>   <span class="mf">1.41e-05</span>     <span class="o">-</span><span class="mf">1.285</span>      <span class="mf">0.199</span>   <span class="o">-</span><span class="mf">4.59e-05</span>    <span class="mf">9.58e-06</span>
<span class="o">==============================================================================</span>
<span class="n">Omnibus</span><span class="p">:</span>                      <span class="mf">623.301</span>   <span class="n">Durbin</span><span class="o">-</span><span class="n">Watson</span><span class="p">:</span>                   <span class="mf">2.001</span>
<span class="n">Prob</span><span class="p">(</span><span class="n">Omnibus</span><span class="p">):</span>                  <span class="mf">0.000</span>   <span class="n">Jarque</span><span class="o">-</span><span class="n">Bera</span> <span class="p">(</span><span class="n">JB</span><span class="p">):</span>           <span class="mf">128496.439</span>
<span class="n">Skew</span><span class="p">:</span>                          <span class="o">-</span><span class="mf">1.393</span>   <span class="n">Prob</span><span class="p">(</span><span class="n">JB</span><span class="p">):</span>                         <span class="mf">0.00</span>
<span class="n">Kurtosis</span><span class="p">:</span>                      <span class="mf">55.051</span>   <span class="n">Cond</span><span class="o">.</span> <span class="n">No</span><span class="o">.</span>                     <span class="mf">5.30e+03</span>
<span class="o">==============================================================================</span>

<span class="n">Warnings</span><span class="p">:</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Standard</span> <span class="n">Errors</span> <span class="n">assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">covariance</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">the</span> <span class="n">errors</span> <span class="ow">is</span> <span class="n">correctly</span> <span class="n">specified</span><span class="o">.</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">The</span> <span class="n">condition</span> <span class="n">number</span> <span class="ow">is</span> <span class="n">large</span><span class="p">,</span> <span class="mf">5.3e+03</span><span class="o">.</span> <span class="n">This</span> <span class="n">might</span> <span class="n">indicate</span> <span class="n">that</span> <span class="n">there</span> <span class="n">are</span>
<span class="n">strong</span> <span class="n">multicollinearity</span> <span class="ow">or</span> <span class="n">other</span> <span class="n">numerical</span> <span class="n">problems</span><span class="o">.</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">resids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">default</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">6</span><span class="p">:],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;resids&#39;</span><span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">resids</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/output_20_0.png" src="../_images/output_20_0.png" />
<p>Since the number lags was directly set, it is good to check whether the
residuals appear to be white noise.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">acf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">resid</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ACF&#39;</span><span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">acf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Residual Autocorrelations&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/output_22_0.png" src="../_images/output_22_0.png" />
</div>
</div>
<div class="section" id="dickey-fuller-gls-testing">
<h2>Dickey-Fuller GLS Testing<a class="headerlink" href="#dickey-fuller-gls-testing" title="Permalink to this headline">¶</a></h2>
<p>The Dickey-Fuller GLS test is an improved version of the ADF which uses
a GLS-detrending regression before running an ADF regression with no
additional deterministic terms. This test is only available with a
constant or constant and time trend (<code class="docutils literal"><span class="pre">trend='c'</span></code> or <code class="docutils literal"><span class="pre">trend='ct'</span></code>).</p>
<p>The results of this test agree with the ADF results.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arch.unitroot</span> <span class="k">import</span> <span class="n">DFGLS</span>
<span class="n">dfgls</span> <span class="o">=</span> <span class="n">DFGLS</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfgls</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>      <span class="n">Dickey</span><span class="o">-</span><span class="n">Fuller</span> <span class="n">GLS</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">2.252</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.024</span>
<span class="n">Lags</span>                               <span class="mi">21</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.59</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.96</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.64</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
<p>The trend can be altered using <code class="docutils literal"><span class="pre">trend</span></code>. The conclusion is the same.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">dfgls</span><span class="o">.</span><span class="n">trend</span> <span class="o">=</span> <span class="s1">&#39;ct&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfgls</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>      <span class="n">Dickey</span><span class="o">-</span><span class="n">Fuller</span> <span class="n">GLS</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">3.406</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.010</span>
<span class="n">Lags</span>                               <span class="mi">21</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span> <span class="ow">and</span> <span class="n">Linear</span> <span class="n">Time</span> <span class="n">Trend</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.43</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.86</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.58</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="phillips-perron-testing">
<h2>Phillips-Perron Testing<a class="headerlink" href="#phillips-perron-testing" title="Permalink to this headline">¶</a></h2>
<p>The Phippips-Perron test is similar to the ADF except that the
regression run does not include lagged values of the first differences.
Instead, the PP test fixed the t-statistic using a long run variance
estimation, implemented using a Newey-West covariance estimator.</p>
<p>By default, the number of lags is automatically set, although this can
be overridden using <code class="docutils literal"><span class="pre">lags</span></code>.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arch.unitroot</span> <span class="k">import</span> <span class="n">PhillipsPerron</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">PhillipsPerron</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">Phillips</span><span class="o">-</span><span class="n">Perron</span> <span class="n">Test</span> <span class="p">(</span><span class="n">Z</span><span class="o">-</span><span class="n">tau</span><span class="p">)</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">3.761</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.003</span>
<span class="n">Lags</span>                               <span class="mi">23</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.44</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.86</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.57</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
<p>It is important that the number of lags is sufficient to pick up any
dependence in the data.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">pp</span><span class="o">.</span><span class="n">lags</span> <span class="o">=</span> <span class="mi">12</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">Phillips</span><span class="o">-</span><span class="n">Perron</span> <span class="n">Test</span> <span class="p">(</span><span class="n">Z</span><span class="o">-</span><span class="n">tau</span><span class="p">)</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">3.876</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.002</span>
<span class="n">Lags</span>                               <span class="mi">12</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.44</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.86</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.57</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
<p>The trend can be changed as well.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">pp</span><span class="o">.</span><span class="n">trend</span> <span class="o">=</span> <span class="s1">&#39;ct&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">Phillips</span><span class="o">-</span><span class="n">Perron</span> <span class="n">Test</span> <span class="p">(</span><span class="n">Z</span><span class="o">-</span><span class="n">tau</span><span class="p">)</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">4.142</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.005</span>
<span class="n">Lags</span>                               <span class="mi">12</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span> <span class="ow">and</span> <span class="n">Linear</span> <span class="n">Time</span> <span class="n">Trend</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.97</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">3.41</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">3.13</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
<p>Finally, the PP testing framework includes two types of tests. One which
uses an ADF-type regression of the first difference on the level, the
other which regresses the level on the level. The default is the <code class="docutils literal"><span class="pre">tau</span></code>
test, which is similar to an ADF regression, although this can be
changed using <code class="docutils literal"><span class="pre">test_type='rho'</span></code>.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">pp</span><span class="o">.</span><span class="n">test_type</span> <span class="o">=</span> <span class="s1">&#39;rho&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">Phillips</span><span class="o">-</span><span class="n">Perron</span> <span class="n">Test</span> <span class="p">(</span><span class="n">Z</span><span class="o">-</span><span class="n">rho</span><span class="p">)</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                <span class="o">-</span><span class="mf">33.974</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.000</span>
<span class="n">Lags</span>                               <span class="mi">12</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span> <span class="ow">and</span> <span class="n">Linear</span> <span class="n">Time</span> <span class="n">Trend</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="o">-</span><span class="mf">29.15</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">21.60</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="o">-</span><span class="mf">18.16</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="kpss-testing">
<h2>KPSS Testing<a class="headerlink" href="#kpss-testing" title="Permalink to this headline">¶</a></h2>
<p>The KPSS test differs from the three previous in that the null is a
stationary process and the alternative is a unit root.</p>
<p>Note that here the null is rejected which indicates that the series
might be a unit root.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arch.unitroot</span> <span class="k">import</span> <span class="n">KPSS</span>
<span class="n">kpss</span> <span class="o">=</span> <span class="n">KPSS</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kpss</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">KPSS</span> <span class="n">Stationarity</span> <span class="n">Test</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                  <span class="mf">0.941</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.004</span>
<span class="n">Lags</span>                               <span class="mi">23</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="mf">0.74</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="mf">0.46</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="mf">0.35</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
</pre></div>
</div>
<p>Changing the trend does not alter the conclusion.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">kpss</span><span class="o">.</span><span class="n">trend</span> <span class="o">=</span> <span class="s1">&#39;ct&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kpss</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">KPSS</span> <span class="n">Stationarity</span> <span class="n">Test</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                  <span class="mf">0.361</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.001</span>
<span class="n">Lags</span>                               <span class="mi">23</span>
<span class="o">-------------------------------------</span>

<span class="n">Trend</span><span class="p">:</span> <span class="n">Constant</span> <span class="ow">and</span> <span class="n">Linear</span> <span class="n">Time</span> <span class="n">Trend</span>
<span class="n">Critical</span> <span class="n">Values</span><span class="p">:</span> <span class="mf">0.22</span> <span class="p">(</span><span class="mi">1</span><span class="o">%</span><span class="p">),</span> <span class="mf">0.15</span> <span class="p">(</span><span class="mi">5</span><span class="o">%</span><span class="p">),</span> <span class="mf">0.12</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span><span class="p">)</span>
<span class="n">Null</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">weakly</span> <span class="n">stationary</span><span class="o">.</span>
<span class="n">Alternative</span> <span class="n">Hypothesis</span><span class="p">:</span> <span class="n">The</span> <span class="n">process</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">unit</span> <span class="n">root</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="variance-ratio-testing">
<h2>Variance Ratio Testing<a class="headerlink" href="#variance-ratio-testing" title="Permalink to this headline">¶</a></h2>
<p>Variance ratio tests are not usually used as unit root tests, and are
instead used for testing whether a financial return series is a pure
random walk versus having some predictability. This example uses the
excess return on the market from Ken French’s data.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas.io.data</span> <span class="k">as</span> <span class="nn">web</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ff</span><span class="o">=</span><span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;F-F_Research_Data_Factors&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">ff</span><span class="o">=</span><span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;F-F_Research_Data_Factors_TXT&#39;</span><span class="p">,</span> <span class="s1">&#39;famafrench&#39;</span><span class="p">)</span>
<span class="n">ff</span> <span class="o">=</span> <span class="n">ff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">excess_market</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Excess Market</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ff</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>       <span class="mi">1</span> <span class="sa">b</span><span class="s1">&#39;Mkt-RF&#39;</span>     <span class="mi">2</span> <span class="sa">b</span><span class="s1">&#39;SMB&#39;</span>     <span class="mi">3</span> <span class="sa">b</span><span class="s1">&#39;HML&#39;</span>      <span class="mi">4</span> <span class="sa">b</span><span class="s1">&#39;RF&#39;</span>
<span class="n">count</span>  <span class="mf">1080.000000</span>  <span class="mf">1080.000000</span>  <span class="mf">1080.000000</span>  <span class="mf">1080.000000</span>
<span class="n">mean</span>      <span class="mf">0.647361</span>     <span class="mf">0.211491</span>     <span class="mf">0.384333</span>     <span class="mf">0.279259</span>
<span class="n">std</span>       <span class="mf">5.381110</span>     <span class="mf">3.216523</span>     <span class="mf">3.522064</span>     <span class="mf">0.254710</span>
<span class="nb">min</span>     <span class="o">-</span><span class="mf">29.130000</span>   <span class="o">-</span><span class="mf">16.700000</span>   <span class="o">-</span><span class="mf">13.280000</span>    <span class="o">-</span><span class="mf">0.060000</span>
<span class="mi">25</span><span class="o">%</span>      <span class="o">-</span><span class="mf">2.022500</span>    <span class="o">-</span><span class="mf">1.560000</span>    <span class="o">-</span><span class="mf">1.290000</span>     <span class="mf">0.030000</span>
<span class="mi">50</span><span class="o">%</span>       <span class="mf">1.000000</span>     <span class="mf">0.065000</span>     <span class="mf">0.215000</span>     <span class="mf">0.250000</span>
<span class="mi">75</span><span class="o">%</span>       <span class="mf">3.650000</span>     <span class="mf">1.772500</span>     <span class="mf">1.732500</span>     <span class="mf">0.430000</span>
<span class="nb">max</span>      <span class="mf">38.850000</span>    <span class="mf">36.700000</span>    <span class="mf">35.460000</span>     <span class="mf">1.350000</span>
</pre></div>
</div>
<p>The variance ratio compares the variance of a 1-period return to that of
a multi-period return. The comparison length has to be set when
initializing the test.</p>
<p>This example compares 1-month to 12-month returns, and the null that the
series is a pure random walk is rejected. Negative values indicate some
positive autocorrelation in the returns (momentum).</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arch.unitroot</span> <span class="k">import</span> <span class="n">VarianceRatio</span>
<span class="n">vr</span> <span class="o">=</span> <span class="n">VarianceRatio</span><span class="p">(</span><span class="n">excess_market</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">Variance</span><span class="o">-</span><span class="n">Ratio</span> <span class="n">Test</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">9.987</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.000</span>
<span class="n">Lags</span>                               <span class="mi">12</span>
<span class="o">-------------------------------------</span>

<span class="n">Computed</span> <span class="k">with</span> <span class="n">overlapping</span> <span class="n">blocks</span> <span class="p">(</span><span class="n">de</span><span class="o">-</span><span class="n">biased</span><span class="p">)</span>
</pre></div>
</div>
<p>By default the VR test uses all overlapping blocks to estimate the
variance of the long period’s return. This can be changed by setting
<code class="docutils literal"><span class="pre">overlap=False</span></code>. This lowers the power but doesn’t change the
conclusion.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;always&#39;</span><span class="p">)</span>  <span class="c1"># Restore warnings</span>

<span class="n">vr</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">Variance</span><span class="o">-</span><span class="n">Ratio</span> <span class="n">Test</span> <span class="n">Results</span>
<span class="o">=====================================</span>
<span class="n">Test</span> <span class="n">Statistic</span>                 <span class="o">-</span><span class="mf">6.096</span>
<span class="n">P</span><span class="o">-</span><span class="n">value</span>                         <span class="mf">0.000</span>
<span class="n">Lags</span>                               <span class="mi">12</span>
<span class="o">-------------------------------------</span>

<span class="n">Computed</span> <span class="k">with</span> <span class="n">non</span><span class="o">-</span><span class="n">overlapping</span> <span class="n">blocks</span>
</pre></div>
</div>
<pre class="literal-block">
c:gitarcharchunitrootunitroot.py:1041: InvalidLengthWarning:
The length of y is not an exact multiple of 12, and so the final
11 observations have been dropped.

  InvalidLengthWarning)
</pre>
<p><strong>Note</strong>: The warning is intentional. It appears here since when it is
not possible to use all data since the data length isn’t an integer
multiple of the long period when using non-overlapping blocks. There is
little reason to use <code class="docutils literal"><span class="pre">overlap=False</span></code>.</p>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="introduction.html" title="previous chapter (use the left arrow)">Introduction</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="tests.html" title="next chapter (use the right arrow)">The Unit Root Tests</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tests.html" title="The Unit Root Tests"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">arch 0+untagged.89.g6a9b5a1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="unitroot.html" >Unit Root Testing</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017, Kevin Sheppard. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>