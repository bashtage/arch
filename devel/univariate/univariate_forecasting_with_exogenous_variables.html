


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="univariate_volatility_scenarios.html">
      
      
        <link rel="next" href="mean.html">
      
      
      <link rel="icon" href="../_static/favicon.ico">
    
    
  
      
        <title>Forecasting with Exogenous Regressors - arch v7.2.1 (+18)</title>
      
    

  <link rel="apple-touch-icon" sizes="180x180" href="../_static/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../_static/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../_static/images/favicon-16x16.png">
  <link rel="manifest" href="../_static/images/site.webmanifest">
  <link rel="mask-icon" href="../_static/images/safari-pinned-tab.svg" color="#2196f3">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../_static/images/browserconfig.xml">

    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.8bc14be58eddc636f.min.css?v=68780cc0" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
        <link rel="stylesheet" type="text/css" href="../_static/css/small_fixes.css?v=64f7a1ef" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Simulating-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="arch v7.2.1 (+18)" class="md-header__button md-logo" aria-label="arch v7.2.1 (+18)" data-md-component="logo">
      <img src="../_static/bw-logo.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            arch v7.2.1 (+18)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Forecasting with Exogenous Regressors
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bashtage/arch/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    arch
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
  

      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="arch v7.2.1 (+18)" class="md-nav__button md-logo" aria-label="arch v7.2.1 (+18)" data-md-component="logo">
      <img src="../_static/bw-logo.svg" alt="logo">
    </a>
    arch v7.2.1 (+18)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bashtage/arch/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    arch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="univariate.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate.rst (reference label)">Univariate Volatility Models</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            <span title="/univariate/univariate.rst (reference label)">Univariate Volatility Models</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/introduction.rst (reference label)">Introduction</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="univariate_volatility_modeling.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_volatility_modeling.ipynb (reference label)">Examples</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/forecasting.rst (reference label)">Forecasting</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="univariate_volatility_forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_volatility_forecasting.ipynb (reference label)">Volatility Forecasting</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="univariate_volatility_forecasting.html#Value-at-Risk-Forecasting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_volatility_forecasting.ipynb#value-at-risk-forecasting (reference label)">Value-<wbr>at-<wbr>Risk Forecasting</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="univariate_volatility_scenarios.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_volatility_scenarios.ipynb (reference label)">Forecasting Scenarios</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb (reference label)">Forecasting with Exogenous Variables</span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb (reference label)">Forecasting with Exogenous Variables</span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Simulating-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#simulating-data (reference label)">Simulating data</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Plotting-the-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#plotting-the-data (reference label)">Plotting the data</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Forecasting-the-X-values" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#forecasting-the-x-values (reference label)">Forecasting the X values</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Fitting-the-model" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#fitting-the-model (reference label)">Fitting the model</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Using-a-dict" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#using-a-dict (reference label)">Using a dict</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using a dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Using-DataFrame" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#using-dataframe (reference label)">Using Data<wbr>Frame</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Using-an-array" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#using-an-array (reference label)">Using an array</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Producing-multiple-forecasts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#producing-multiple-forecasts (reference label)">Producing multiple forecasts</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x-input-array-sizes" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#x-input-array-sizes (reference label)">x input array sizes</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Special-Cases-with-a-single-x-variable" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#special-cases-with-a-single-x-variable (reference label)">Special Cases with a single x variable</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Simulation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#simulation (reference label)">Simulation</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Static-out-of-sample-x" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#static-out-of-sample-x (reference label)">Static out-<wbr>of-<wbr>sample x</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Simulating-the-out-of-sample-x" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#simulating-the-out-of-sample-x (reference label)">Simulating the out-<wbr>of-<wbr>sample x</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Conditional-Mean-Alignment-vs.-Forecast-Alignment" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#conditional-mean-alignment-vs.-forecast-alignment (reference label)">Conditional Mean Alignment vs.<wbr> Forecast Alignment</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conditional Mean Alignment vs. Forecast Alignment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Conditional-Mean-uses-target-alignment" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#conditional-mean-uses-target-alignment (reference label)">Conditional Mean uses target alignment</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forecast-uses-origin-alignment" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#forecast-uses-origin-alignment (reference label)">forecast uses origin alignment</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#(Nearly)-out-of-sample-forecasts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#(nearly)-out-of-sample-forecasts (reference label)"><wbr>(Nearly) out-<wbr>of-<wbr>sample forecasts</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#True-out-of-sample-forecasts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#true-out-of-sample-forecasts (reference label)">True out-<wbr>of-<wbr>sample forecasts</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="mean.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/mean.rst (reference label)">Mean Models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="volatility.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/volatility.rst (reference label)">Volatility Processes</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="univariate_using_fixed_variance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/univariate_using_fixed_variance.ipynb (reference label)">Using the Fixed Variance Process</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="distribution.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/distribution.rst (reference label)">Distributions</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="results.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/results.rst (reference label)">Results</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="utility.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/utility.rst (reference label)">Utilities</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="background.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/univariate/background.rst (reference label)">Background and References</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../bootstrap/bootstrap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/bootstrap/bootstrap.rst (reference label)">Bootstrapping</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiple-comparison/multiple-comparisons.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/multiple-comparison/multiple-comparisons.rst (reference label)">Multiple Comparison Problems</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../unitroot/unitroot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/unitroot/unitroot.rst (reference label)">Unit Root Testing</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../unitroot/unitroot.html#cointegration-analysis" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/unitroot/unitroot.rst#cointegration-analysis (reference label)">Cointegration Analysis</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../covariance/covariance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/covariance/covariance.rst (reference label)">Long-<wbr>run Covariance Estimation</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)">API Reference</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../types.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/types.rst (reference label)">Common Type Definitions</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../changes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/changes.rst (reference label)">Change Log</span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Simulating-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#simulating-data (reference label)">Simulating data</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Plotting-the-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#plotting-the-data (reference label)">Plotting the data</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Forecasting-the-X-values" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#forecasting-the-x-values (reference label)">Forecasting the X values</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Fitting-the-model" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#fitting-the-model (reference label)">Fitting the model</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Using-a-dict" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#using-a-dict (reference label)">Using a dict</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using a dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Using-DataFrame" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#using-dataframe (reference label)">Using Data<wbr>Frame</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Using-an-array" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#using-an-array (reference label)">Using an array</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Producing-multiple-forecasts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#producing-multiple-forecasts (reference label)">Producing multiple forecasts</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x-input-array-sizes" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#x-input-array-sizes (reference label)">x input array sizes</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Special-Cases-with-a-single-x-variable" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#special-cases-with-a-single-x-variable (reference label)">Special Cases with a single x variable</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Simulation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#simulation (reference label)">Simulation</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Static-out-of-sample-x" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#static-out-of-sample-x (reference label)">Static out-<wbr>of-<wbr>sample x</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Simulating-the-out-of-sample-x" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#simulating-the-out-of-sample-x (reference label)">Simulating the out-<wbr>of-<wbr>sample x</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Conditional-Mean-Alignment-vs.-Forecast-Alignment" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#conditional-mean-alignment-vs.-forecast-alignment (reference label)">Conditional Mean Alignment vs.<wbr> Forecast Alignment</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conditional Mean Alignment vs. Forecast Alignment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Conditional-Mean-uses-target-alignment" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#conditional-mean-uses-target-alignment (reference label)">Conditional Mean uses target alignment</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forecast-uses-origin-alignment" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#forecast-uses-origin-alignment (reference label)">forecast uses origin alignment</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#(Nearly)-out-of-sample-forecasts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#(nearly)-out-of-sample-forecasts (reference label)"><wbr>(Nearly) out-<wbr>of-<wbr>sample forecasts</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#True-out-of-sample-forecasts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/univariate/univariate_forecasting_with_exogenous_variables.ipynb#true-out-of-sample-forecasts (reference label)">True out-<wbr>of-<wbr>sample forecasts</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  



<h1 id="Forecasting-with-Exogenous-Regressors">Forecasting with Exogenous Regressors<a class="headerlink" href="#Forecasting-with-Exogenous-Regressors" title="Link to this heading">¶</a></h1>
<p>This notebook provides examples of the accepted data structures for passing the expected value of exogenous variables when these are included in the mean. For example, consider an AR(1) with 2 exogenous variables. The mean dynamics are</p>
<div class="math notranslate nohighlight">
\[Y_t = \phi_0 + \phi_1 Y_{t-1} + \beta_0 X_{0,t} + \beta_1 X_{1,t} + \epsilon_t.\]</div>
<p>The <span class="math notranslate nohighlight">\(h\)</span>-step forecast, <span class="math notranslate nohighlight">\(E_{T}[Y_{t+h}]\)</span>, depends on the conditional expectation of <span class="math notranslate nohighlight">\(X_{0,T+h}\)</span> and <span class="math notranslate nohighlight">\(X_{1,T+h}\)</span>,</p>
<div class="math notranslate nohighlight">
\[E_{T}[Y_{T+h}] = \phi_0 + \phi_1 E_{T}[Y_{T+h-1}] + \beta_0 E_{T}[X_{0,T+h}] +\beta_1 E_{T}[X_{1,T+h}]\]</div>
<p>where <span class="math notranslate nohighlight">\(E_{T}[Y_{T+h-1}]\)</span> has been recursively computed.</p>
<p>In order to construct forecasts up to some horizon <span class="math notranslate nohighlight">\(h\)</span>, it is necessary to pass <span class="math notranslate nohighlight">\(2\times h\)</span> values (<span class="math notranslate nohighlight">\(h\)</span> for each series). If using the features of <code class="docutils literal notranslate"><span class="pre">forecast</span></code> that allow many forecast to be specified, it necessary to supply <span class="math notranslate nohighlight">\(n \times 2 \times h\)</span> values.</p>
<p>There are two general purpose data structures that can be used for any number of exogenous variables and any number steps ahead:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - The values can be pass using a <code class="docutils literal notranslate"><span class="pre">dict</span></code> where the keys are the variable names and the values are 2-dimensional arrays. This is the most natural generalization of a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to 3-dimensions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array</span></code> - The vales can alternatively be passed as a 3-d NumPy <code class="docutils literal notranslate"><span class="pre">array</span></code> where dimension 0 tracks the regressor index, dimension 1 is the time period and dimension 2 is the horizon.</p></li>
</ul>
<p>When a model contains a single exogenous regressor it is possible to use a 2-d array or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> where dim0 tracks the time period where the forecast is generated and dimension 1 tracks the horizon.</p>
<p>In the special case where a model contains a single regressor <em>and</em> the horizon is 1, then a 1-d array or pandas Series can be used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span>

<span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;savefig&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;sans-serif&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Simulating-data">Simulating data<a class="headerlink" href="#Simulating-data" title="Link to this heading">¶</a></h2>
<p>Two <span class="math notranslate nohighlight">\(X\)</span> variables are simulated and are assumed to follow independent AR(1) processes. The data is then assumed to follow an ARX(1) with 2 exogenous regressors and GARCH(1,1) errors.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">arch.univariate</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARX</span><span class="p">,</span> <span class="n">GARCH</span><span class="p">,</span> <span class="n">ZeroMean</span><span class="p">,</span> <span class="n">arch_model</span>

<span class="n">burn</span> <span class="o">=</span> <span class="mi">250</span>

<span class="n">x_mod</span> <span class="o">=</span> <span class="n">ARX</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">x_mod</span><span class="o">.</span><span class="n">simulate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nobs</span><span class="o">=</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">burn</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">x_mod</span><span class="o">.</span><span class="n">simulate</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nobs</span><span class="o">=</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">burn</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>

<span class="n">resid_mod</span> <span class="o">=</span> <span class="n">ZeroMean</span><span class="p">(</span><span class="n">volatility</span><span class="o">=</span><span class="n">GARCH</span><span class="p">())</span>
<span class="n">resids</span> <span class="o">=</span> <span class="n">resid_mod</span><span class="o">.</span><span class="n">simulate</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">nobs</span><span class="o">=</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">burn</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>

<span class="n">phi1</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">phi0</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">resids</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi0</span> <span class="o">+</span> <span class="n">phi1</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">resids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:]</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:]</span>
<span class="n">y</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Plotting-the-data">Plotting the data<a class="headerlink" href="#Plotting-the-data" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ARX&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/univariate_univariate_forecasting_with_exogenous_variables_5_0.png" src="../_images/univariate_univariate_forecasting_with_exogenous_variables_5_0.png" />
</div>
</div>
<h2 id="Forecasting-the-X-values">Forecasting the X values<a class="headerlink" href="#Forecasting-the-X-values" title="Link to this heading">¶</a></h2>
<p>The forecasts of <span class="math notranslate nohighlight">\(Y\)</span> depend on forecasts of <span class="math notranslate nohighlight">\(X_0\)</span> and <span class="math notranslate nohighlight">\(X_1\)</span>. Both of these follow simple AR(1), and so we can construct the forecasts for all time horizons. Note that the value in position <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> is the time-<code class="docutils literal notranslate"><span class="pre">i</span></code> forecast for horizon <code class="docutils literal notranslate"><span class="pre">j+1</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">x0_oos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x1_oos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">x0_oos</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">x0_oos</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">last</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">x1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">x1_oos</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">x1_oos</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">last</span>

<span class="n">x1_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([4.9001286 , 4.9500643 , 4.97503215, 4.98751607, 4.99375804,
       4.99687902, 4.99843951, 4.99921975, 4.99960988, 4.99980494])
</pre></div></div>
</div>
<h2 id="Fitting-the-model">Fitting the model<a class="headerlink" href="#Fitting-the-model" title="Link to this heading">¶</a></h2>
<p>Next, the model is fit. The parameters are precisely estimated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">x0</span><span class="p">,</span> <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x1</span><span class="p">})</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">arch_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;ARX&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          AR-X - GARCH Model Results
==============================================================================
Dep. Variable:                   data   R-squared:                       0.992
Mean Model:                      AR-X   Adj. R-squared:                  0.992
Vol Model:                      GARCH   Log-Likelihood:               -1284.08
Distribution:                  Normal   AIC:                           2582.16
Method:            Maximum Likelihood   BIC:                           2616.51
                                        No. Observations:                  999
Date:                Wed, Mar 12 2025   Df Residuals:                      995
Time:                        15:32:37   Df Model:                            4
                               Mean Model
========================================================================
                 coef    std err          t      P&gt;|t|  95.0% Conf. Int.
------------------------------------------------------------------------
Const          3.1723      0.145     21.914 1.904e-106 [  2.889,  3.456]
data[1]        0.6946  3.489e-03    199.089      0.000 [  0.688,  0.701]
x0             2.0150  1.892e-02    106.501      0.000 [  1.978,  2.052]
x1            -2.0412  2.411e-02    -84.675      0.000 [ -2.088, -1.994]
                             Volatility Model
==========================================================================
                 coef    std err          t      P&gt;|t|    95.0% Conf. Int.
--------------------------------------------------------------------------
omega          0.1431  4.356e-02      3.286  1.016e-03 [5.776e-02,  0.229]
alpha[1]       0.1186  3.563e-02      3.329  8.718e-04 [4.878e-02,  0.188]
beta[1]        0.6989  7.373e-02      9.478  2.590e-21   [  0.554,  0.843]
==========================================================================

Covariance estimator: robust
</pre></div></div>
</div>
<h2 id="Using-a-dict">Using a <code class="docutils literal notranslate"><span class="pre">dict</span></code><a class="headerlink" href="#Using-a-dict" title="Link to this heading">¶</a></h2>
<p>The first approach uses a dict to pass the two variables. The key consideration here is the the keys of the dictionary must <strong>exactly</strong> match the variable names (<code class="docutils literal notranslate"><span class="pre">x0</span></code> and <code class="docutils literal notranslate"><span class="pre">x1</span></code> here). The dictionary here contains only the final row of the forecast values since <code class="docutils literal notranslate"><span class="pre">forecast</span></code> will only make forecasts beginning from the final in-sample observation by default.</p>
<h3 id="Using-DataFrame">Using <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#Using-DataFrame" title="Link to this heading">¶</a></h3>
<p>While these examples make use of NumPy arrays, these can be <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>. This allows the index to be used to track the forecast origination point, which can be a helpful device.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog_fcast</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x1_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]}</span>
<span class="n">forecasts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog_fcast</span><span class="p">)</span>
<span class="n">forecasts</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/univariate_univariate_forecasting_with_exogenous_variables_11_1.png" src="../_images/univariate_univariate_forecasting_with_exogenous_variables_11_1.png" />
</div>
</div>
<h2 id="Using-an-array">Using an <code class="docutils literal notranslate"><span class="pre">array</span></code><a class="headerlink" href="#Using-an-array" title="Link to this heading">¶</a></h2>
<p>An array can alternatively be used. This frees the restriction on matching the variable names although the order must match instead. The forecast values are 2 (variables) by 1 (forecast) by 10 (horizon).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog_fcast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x1_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The shape is </span><span class="si">{</span><span class="n">exog_fcast</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">array_forecasts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog_fcast</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array_forecasts</span><span class="o">.</span><span class="n">mean</span> <span class="o">-</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The shape is (2, 1, 10)
     h.01  h.02  h.03  h.04  h.05  h.06  h.07  h.08  h.09  h.10
999   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
</pre></div></div>
</div>
<h2 id="Producing-multiple-forecasts">Producing multiple forecasts<a class="headerlink" href="#Producing-multiple-forecasts" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">forecast</span></code> can produce multiple forecasts using the same fit model. Here the model is fit to the first 500 observations and then forecasting for the remaining values are produced. It must be the case that the <code class="docutils literal notranslate"><span class="pre">x</span></code> values passed for <code class="docutils literal notranslate"><span class="pre">forecast</span></code> have the same number of rows as the table of forecasts produced.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="n">last_obs</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">exog_fcast</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">:],</span> <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x1_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">:]}</span>
<span class="n">multi_forecasts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog_fcast</span><span class="p">)</span>
<span class="n">multi_forecasts</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h.01</th>
      <th>h.02</th>
      <th>h.03</th>
      <th>h.04</th>
      <th>h.05</th>
      <th>h.06</th>
      <th>h.07</th>
      <th>h.08</th>
      <th>h.09</th>
      <th>h.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>990</th>
      <td>28.502770</td>
      <td>27.542945</td>
      <td>25.839138</td>
      <td>23.868494</td>
      <td>21.891511</td>
      <td>20.042760</td>
      <td>18.383840</td>
      <td>16.934660</td>
      <td>15.692083</td>
      <td>14.641025</td>
    </tr>
    <tr>
      <th>991</th>
      <td>29.173559</td>
      <td>27.195173</td>
      <td>24.957898</td>
      <td>22.750646</td>
      <td>20.713714</td>
      <td>18.905391</td>
      <td>17.339425</td>
      <td>16.006284</td>
      <td>14.885246</td>
      <td>13.951224</td>
    </tr>
    <tr>
      <th>992</th>
      <td>28.484765</td>
      <td>25.842777</td>
      <td>23.278202</td>
      <td>20.971538</td>
      <td>18.978273</td>
      <td>17.295547</td>
      <td>15.895516</td>
      <td>14.741784</td>
      <td>13.797251</td>
      <td>13.027599</td>
    </tr>
    <tr>
      <th>993</th>
      <td>23.173368</td>
      <td>20.057907</td>
      <td>17.679846</td>
      <td>15.867363</td>
      <td>14.485079</td>
      <td>13.428832</td>
      <td>12.619514</td>
      <td>11.997439</td>
      <td>11.517690</td>
      <td>11.146459</td>
    </tr>
    <tr>
      <th>994</th>
      <td>18.735344</td>
      <td>16.257246</td>
      <td>14.469457</td>
      <td>13.183147</td>
      <td>12.258309</td>
      <td>11.592869</td>
      <td>11.113190</td>
      <td>10.766486</td>
      <td>10.515053</td>
      <td>10.332001</td>
    </tr>
    <tr>
      <th>995</th>
      <td>22.039455</td>
      <td>20.504788</td>
      <td>18.875821</td>
      <td>17.355170</td>
      <td>16.018235</td>
      <td>14.880399</td>
      <td>13.930390</td>
      <td>13.146639</td>
      <td>12.505083</td>
      <td>11.982703</td>
    </tr>
    <tr>
      <th>996</th>
      <td>20.348831</td>
      <td>18.877129</td>
      <td>17.457360</td>
      <td>16.176943</td>
      <td>15.064109</td>
      <td>14.118377</td>
      <td>13.326293</td>
      <td>12.669501</td>
      <td>12.128783</td>
      <td>11.685989</td>
    </tr>
    <tr>
      <th>997</th>
      <td>13.532177</td>
      <td>12.007341</td>
      <td>11.214290</td>
      <td>10.781862</td>
      <td>10.529035</td>
      <td>10.367867</td>
      <td>10.255698</td>
      <td>10.171726</td>
      <td>10.105617</td>
      <td>10.052009</td>
    </tr>
    <tr>
      <th>998</th>
      <td>10.502678</td>
      <td>9.375227</td>
      <td>8.848259</td>
      <td>8.650802</td>
      <td>8.630250</td>
      <td>8.700070</td>
      <td>8.811211</td>
      <td>8.936181</td>
      <td>9.060011</td>
      <td>9.175037</td>
    </tr>
    <tr>
      <th>999</th>
      <td>12.366257</td>
      <td>12.516103</td>
      <td>12.402110</td>
      <td>12.164105</td>
      <td>11.879613</td>
      <td>11.590654</td>
      <td>11.318890</td>
      <td>11.074316</td>
      <td>10.860322</td>
      <td>10.676670</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The plot of the final 5 forecast paths shows the the mean reversion of the process.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">_</span> <span class="o">=</span> <span class="n">multi_forecasts</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/univariate_univariate_forecasting_with_exogenous_variables_17_0.png" src="../_images/univariate_univariate_forecasting_with_exogenous_variables_17_0.png" />
</div>
</div>
<p>The previous example made use of dictionaries where each of the values was a 500 (number of forecasts) by 10 (horizon) array. The alternative format can be used where <code class="docutils literal notranslate"><span class="pre">x</span></code> is a 3-d array with shape 2 (variables) by 500 (forecasts) by 10 (horizon).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog_fcast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">:],</span> <span class="n">x1_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">:]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exog_fcast</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">array_multi_forecasts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog_fcast</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">array_multi_forecasts</span><span class="o">.</span><span class="n">mean</span> <span class="o">-</span> <span class="n">multi_forecasts</span><span class="o">.</span><span class="n">mean</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 500, 10)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(0.0)
</pre></div></div>
</div>
<h2 id="x-input-array-sizes"><code class="docutils literal notranslate"><span class="pre">x</span></code> input array sizes<a class="headerlink" href="#x-input-array-sizes" title="Link to this heading">¶</a></h2>
<p>While the natural shape of the <code class="docutils literal notranslate"><span class="pre">x</span></code> data is the number of forecasts, it is also possible to pass an <code class="docutils literal notranslate"><span class="pre">x</span></code> that has the same shape as the <code class="docutils literal notranslate"><span class="pre">y</span></code> used to construct the model. The may simplify tracking the origin points of the forecast. Values are are not needed are ignored. In this example, the out-of-sample values are 2 by 1000 (original number of observations) by 10. Only the final 500 are used.</p>
<div class="admonition warning">
<div class="admonition-title"><h3></div><p>WARNING</p>
</h3><p>Other sizes are not allowed. The size of the out-of-sample data must either match the original data size or the number of forecasts.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog_fcast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0_oos</span><span class="p">,</span> <span class="n">x1_oos</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exog_fcast</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">array_multi_forecasts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog_fcast</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">array_multi_forecasts</span><span class="o">.</span><span class="n">mean</span> <span class="o">-</span> <span class="n">multi_forecasts</span><span class="o">.</span><span class="n">mean</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 1000, 10)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(0.0)
</pre></div></div>
</div>
<h2 id="Special-Cases-with-a-single-x-variable">Special Cases with a single <code class="docutils literal notranslate"><span class="pre">x</span></code> variable<a class="headerlink" href="#Special-Cases-with-a-single-x-variable" title="Link to this heading">¶</a></h2>
<p>When a model consists of a single exogenous regressor, then <code class="docutils literal notranslate"><span class="pre">x</span></code> can be a 1-d or 2-d array (or <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">arch_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;ARX&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          AR-X - GARCH Model Results
==============================================================================
Dep. Variable:                   data   R-squared:                       0.942
Mean Model:                      AR-X   Adj. R-squared:                  0.941
Vol Model:                      GARCH   Log-Likelihood:               -2309.26
Distribution:                  Normal   AIC:                           4630.53
Method:            Maximum Likelihood   BIC:                           4659.97
                                        No. Observations:                  999
Date:                Wed, Mar 12 2025   Df Residuals:                      996
Time:                        15:32:38   Df Model:                            3
                               Mean Model
========================================================================
                 coef    std err          t      P&gt;|t|  95.0% Conf. Int.
------------------------------------------------------------------------
Const         -6.3085      0.271    -23.313 3.260e-120 [ -6.839, -5.778]
data[1]        0.7555  1.041e-02     72.592      0.000 [  0.735,  0.776]
x0             1.7580  5.930e-02     29.644 4.038e-193 [  1.642,  1.874]
                             Volatility Model
==========================================================================
                 coef    std err          t      P&gt;|t|    95.0% Conf. Int.
--------------------------------------------------------------------------
omega          4.2291      1.660      2.548  1.085e-02   [  0.975,  7.483]
alpha[1]       0.0927  3.883e-02      2.386  1.702e-02 [1.655e-02,  0.169]
beta[1]        0.2026      0.291      0.695      0.487   [ -0.369,  0.774]
==========================================================================

Covariance estimator: robust
</pre></div></div>
</div>
<p>These two examples show that both formats can be used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">forecast_1d</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">forecast_2d</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">forecast_1d</span><span class="o">.</span><span class="n">mean</span> <span class="o">-</span> <span class="n">forecast_2d</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>

<span class="c1">## Simulation-forecasting</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">arch_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;ARX&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
     h.01  h.02  h.03  h.04  h.05  h.06  h.07  h.08  h.09  h.10
999   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
</pre></div></div>
</div>
<h2 id="Simulation">Simulation<a class="headerlink" href="#Simulation" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">forecast</span></code> supports simulating paths. When forecasting a model with exogenous variables, the same value is used to in all mean paths. If you wish to also simulate the paths of the <code class="docutils literal notranslate"><span class="pre">x</span></code> variables, these need to generated and then passed inside a loop.</p>
<h3 id="Static-out-of-sample-x">Static out-of-sample <code class="docutils literal notranslate"><span class="pre">x</span></code><a class="headerlink" href="#Static-out-of-sample-x" title="Link to this heading">¶</a></h3>
<p>This first example shows that variance of the paths when the same <code class="docutils literal notranslate"><span class="pre">x</span></code> values are used in the forecast. There is a sense the out-of-sample <code class="docutils literal notranslate"><span class="pre">x</span></code> are treated as deterministic.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">x0_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x1_oos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>
<span class="n">sim_fixedx</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">,</span> <span class="n">simulations</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sim_fixedx</span><span class="o">.</span><span class="n">simulations</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1.02543568, 1.09393378, 1.16212056, 1.1714313 , 1.19564701,
        1.29694909, 1.3594505 , 1.34728349, 1.12074703, 1.31243705]])
</pre></div></div>
</div>
<h3 id="Simulating-the-out-of-sample-x">Simulating the out-of-sample <code class="docutils literal notranslate"><span class="pre">x</span></code><a class="headerlink" href="#Simulating-the-out-of-sample-x" title="Link to this heading">¶</a></h3>
<p>This example simulates distinct paths for the two exogenous variables and then simulates a single path. This is then repeated 100 times. We see that variance is much higher when we account for variation in the x data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomState</span>


<span class="k">def</span><span class="w"> </span><span class="nf">sim_ar1</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">RandomState</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">shocks</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">initial</span> <span class="o">+</span> <span class="n">shocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="p">):</span>
        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">shocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="n">simulations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">(</span><span class="mi">20210301</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">x0_sim</span> <span class="o">=</span> <span class="n">sim_ar1</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span> <span class="n">x0</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
    <span class="n">x1_sim</span> <span class="o">=</span> <span class="n">sim_ar1</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]),</span> <span class="n">x1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">x0_sim</span><span class="p">,</span> <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x1_sim</span><span class="p">}</span>
    <span class="n">fcast</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">,</span> <span class="n">simulations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">simulations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fcast</span><span class="o">.</span><span class="n">simulations</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>Finally the standard deviation is quite a bit larger. This is a most accurate value fo the long-run variance of the forecast residuals which should account for dynamics in the model and any exogenous regressors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">joined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">joined</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[3.25342897, 4.96501065, 6.4089737 , 7.44885243, 8.40005867,
        8.62783512, 8.64754658, 8.73418236, 9.0733523 , 9.37254782]])
</pre></div></div>
</div>
<h2 id="Conditional-Mean-Alignment-vs.-Forecast-Alignment">Conditional Mean Alignment vs. Forecast Alignment<a class="headerlink" href="#Conditional-Mean-Alignment-vs.-Forecast-Alignment" title="Link to this heading">¶</a></h2>
<p>When fitting a model with exogenous variables, the data are aligned so that the values in <code class="docutils literal notranslate"><span class="pre">x[j]</span></code> are used to compute the conditional mean of <code class="docutils literal notranslate"><span class="pre">y[j]</span></code>. For example, in the case of an AR(1)-X, the model is</p>
<div class="math notranslate nohighlight">
\[Y_t = \phi_0 + \phi_1 Y_{t-1} + \beta X_{t} + \epsilon_t.\]</div>
<p>We can recover the conditional mean by subtracting the residuals from the original data. When we do this we see that the conditional mean of observation 0 is missing since we need one lag of <span class="math notranslate nohighlight">\(Y\)</span> to fit the model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">arch_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;ARX&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">resid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0            NaN
1      13.846730
2      12.954885
3      14.268464
4      15.531762
         ...
995    22.924661
996    22.194351
997    15.952289
998    12.513022
999    13.596591
Length: 1000, dtype: float64
</pre></div></div>
</div>
<h3 id="Conditional-Mean-uses-target-alignment">Conditional Mean uses target alignment<a class="headerlink" href="#Conditional-Mean-uses-target-alignment" title="Link to this heading">¶</a></h3>
<p>When modeling the conditional mean in an AR-X, HAR-X, or LS model, the <span class="math notranslate nohighlight">\(X\)</span> data is target-aligned. This requires that when modeling the mean of <code class="docutils literal notranslate"><span class="pre">y[t]</span></code>, the correct values of <span class="math notranslate nohighlight">\(X\)</span> must appear in <code class="docutils literal notranslate"><span class="pre">x[t]</span></code>. Mathematically, the <span class="math notranslate nohighlight">\(X\)</span> matrix used when estimating a model should have the structure (using the Python indexing convention of a T-element data set having indices 0, 1, …, T-1):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{c}
X_{0}\\
X_{1}\\
\vdots\\
X_{T-1}
\end{array}\right]\end{split}\]</div>
<h3 id="forecast-uses-origin-alignment"><code class="docutils literal notranslate"><span class="pre">forecast</span></code> uses origin alignment<a class="headerlink" href="#forecast-uses-origin-alignment" title="Link to this heading">¶</a></h3>
<p>Forecasting with <span class="math notranslate nohighlight">\(X\)</span> values aligns them differently. When producing a 1-step-ahead forecast for <span class="math notranslate nohighlight">\(Y_{t+1}\)</span> using information available at time <span class="math notranslate nohighlight">\(t\)</span>, the <span class="math notranslate nohighlight">\(X\)</span> values used for this forecast must appear in for <code class="docutils literal notranslate"><span class="pre">t</span></code>. This is needed since when once wants to produce true out-of-sample forecasts (see below), it must be the case that the final row of <code class="docutils literal notranslate"><span class="pre">x</span></code> passed <code class="docutils literal notranslate"><span class="pre">forecast</span></code> must all occur after the final time stamp of the most recent <span class="math notranslate nohighlight">\(Y\)</span> value. Mathematically, the <span class="math notranslate nohighlight">\(X\)</span>
matrix used in forecasting should have the following structure (using Python indexing convention so that a <span class="math notranslate nohighlight">\(T\)</span> observation dataset will have indices 0, 1, …, T-1).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{cccc}
E\left[X_{1}|\mathcal{F}_0\right] &amp; E\left[X_{2}|\mathcal{F}_0\right] &amp; \ldots &amp; E\left[X_{h|\mathcal{F}_0}\right]\\
E\left[X_{2}|\mathcal{F}_1\right] &amp; E\left[X_{3}|\mathcal{F}_0\right] &amp; \ldots &amp; E\left[X_{h+1}|\mathcal{F}_1\right]\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
E\left[X_{T}|\mathcal{F}_{T-1}\right] &amp; E\left[X_{T+1}|\mathcal{F}_{T-1}\right] &amp; \ldots &amp; E\left[X_{T+h-1}|\mathcal{F}_{T-1}\right]
\end{array}\right]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\mathcal{F}_{s}\)</span> is the time-<span class="math notranslate nohighlight">\(s\)</span> information set.</p>
<p>If you use the same <code class="docutils literal notranslate"><span class="pre">x</span></code> value in the model when forecasting, you will see different values due to this alignment difference. Naively using the same <code class="docutils literal notranslate"><span class="pre">x</span></code> values ie equivalent to setting</p>
<div class="math notranslate nohighlight">
\[E\left[X_{s}|\mathcal{F}_{s-1} \right] = X_{s-1}\]</div>
<p>In general this would not be correct when forecasting, and will always produce forecasts that differ from the conditional mean. In order to recover the conditional mean using the forecast function, it is necessary to <code class="docutils literal notranslate"><span class="pre">shift</span></code> the <span class="math notranslate nohighlight">\(X\)</span> values by -1, so that once shifted, the <code class="docutils literal notranslate"><span class="pre">x</span></code> values will have the relationship</p>
<div class="math notranslate nohighlight">
\[E\left[X_{s}|\mathcal{F}_{s-1} \right] = X_{s} .\]</div>
<p>Here we shift the <span class="math notranslate nohighlight">\(X\)</span> data by <code class="docutils literal notranslate"><span class="pre">-1</span></code> so <code class="docutils literal notranslate"><span class="pre">x[s]</span></code> is treated as being in the information set for <code class="docutils literal notranslate"><span class="pre">y[s-1]</span></code>. Also, note that the final forecast is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. Conceptually this must be the case because the value of <span class="math notranslate nohighlight">\(X\)</span> at 999 should be ahead of 999 (i.e., at observation 1,000), and we do not have this value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">exog</span><span class="p">[[</span><span class="n">col</span><span class="p">]]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog</span><span class="p">}</span>
<span class="n">fcast</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog_dict</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">fcast</span><span class="o">.</span><span class="n">mean</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h.1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>13.846730</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.954885</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.268464</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.531762</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16.054693</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>22.194351</td>
    </tr>
    <tr>
      <th>996</th>
      <td>15.952289</td>
    </tr>
    <tr>
      <th>997</th>
      <td>12.513022</td>
    </tr>
    <tr>
      <th>998</th>
      <td>13.596591</td>
    </tr>
    <tr>
      <th>999</th>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 1 columns</p>
</div></div>
</div>
<h3 id="(Nearly)-out-of-sample-forecasts">(Nearly) out-of-sample forecasts<a class="headerlink" href="#(Nearly)-out-of-sample-forecasts" title="Link to this heading">¶</a></h3>
<p>These “in-sample” forecasts are not really forecasts at all but are just fitted values with a different alignment. If you want real (nearly) out-of-sample forecasts<span class="math notranslate nohighlight">\(\dagger\)</span>, it is necessary to replace the actual values of <span class="math notranslate nohighlight">\(X\)</span> with their conditional expectation. This can be done by taking the fitted values from AR(1) models of the <span class="math notranslate nohighlight">\(X\)</span> variables.</p>
<p><span class="math notranslate nohighlight">\(\dagger\)</span> These are not true out-of-sample since the parameters were estimated using data from that same range of indices where these forecasts target. True out-of-sample requires both using forecast <span class="math notranslate nohighlight">\(X\)</span> values and parameters estimated without the period being forecasted.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res0</span> <span class="o">=</span> <span class="n">ARX</span><span class="p">(</span><span class="n">exog</span><span class="p">[</span><span class="s2">&quot;x0&quot;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res1</span> <span class="o">=</span> <span class="n">ARX</span><span class="p">(</span><span class="n">exog</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">res0</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">res1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">forecast_x</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x0f&quot;</span><span class="p">,</span> <span class="s2">&quot;x1f&quot;</span><span class="p">]</span>
<span class="n">in_samp_forcast_exog</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">forecast_x</span><span class="p">[[</span><span class="s2">&quot;x0f&quot;</span><span class="p">]],</span> <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">forecast_x</span><span class="p">[[</span><span class="s2">&quot;x1f&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)}</span>
<span class="n">fcast</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">in_samp_forcast_exog</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">fcast</span><span class="o">.</span><span class="n">mean</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h.1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.566324</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.946105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.424288</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13.448492</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15.973093</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>21.921407</td>
    </tr>
    <tr>
      <th>996</th>
      <td>19.097159</td>
    </tr>
    <tr>
      <th>997</th>
      <td>14.559433</td>
    </tr>
    <tr>
      <th>998</th>
      <td>11.402682</td>
    </tr>
    <tr>
      <th>999</th>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 1 columns</p>
</div></div>
</div>
<h3 id="True-out-of-sample-forecasts">True out-of-sample forecasts<a class="headerlink" href="#True-out-of-sample-forecasts" title="Link to this heading">¶</a></h3>
<p>In order to make a true out-of-sample prediction, we need the expected values of <code class="docutils literal notranslate"><span class="pre">X</span></code> from the end of the data we have. These can be constructed by forecasting the two <span class="math notranslate nohighlight">\(X\)</span> variables and then passing these values as <code class="docutils literal notranslate"><span class="pre">x</span></code> to <code class="docutils literal notranslate"><span class="pre">forecast</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">arch_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="s2">&quot;ARX&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">actual_x_oos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="n">res0</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
    <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">res1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">fcasts</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">actual_x_oos</span><span class="p">)</span>
<span class="n">fcasts</span><span class="o">.</span><span class="n">mean</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h.01</th>
      <th>h.02</th>
      <th>h.03</th>
      <th>h.04</th>
      <th>h.05</th>
      <th>h.06</th>
      <th>h.07</th>
      <th>h.08</th>
      <th>h.09</th>
      <th>h.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>999</th>
      <td>12.664299</td>
      <td>13.190316</td>
      <td>13.46142</td>
      <td>13.583769</td>
      <td>13.620349</td>
      <td>13.608876</td>
      <td>13.572018</td>
      <td>13.523348</td>
      <td>13.470885</td>
      <td>13.41923</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>








  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2021, Kevin Sheppard.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/bashtage/arch" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/arch/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593254" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "Release", "version": "https://bashtage.github.io/arch/"}, {"aliases": [], "title": "Development", "version": "https://bashtage.github.io/arch/devel/"}, {"aliases": [], "title": "RTD (Release)", "version": "https://arch.readthedocs.io/"}], "versionPath": null}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>